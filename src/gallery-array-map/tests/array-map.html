<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd"> 
<html>
    <head>
        <title>Array.map tests</title>
    </head>
    <body class="yui3-skin-sam">
        <h1>Array.map Tests</h1>
        <div id="console"></div>
        <script src="http://yui.yahooapis.com/3.1.1/build/yui/yui-min.js"></script>
        <script src="../../../build/gallery-array-map/gallery-array-map-debug.js"></script>
        <script>
            YUI({
                useConsoleOutput: true,
                logInclude: { TestRunner: true }
            }).use('test', 'console', 'gallery-array-map', function (Y) {
                var ascii, plural, squareRoots,
                    body = Y.one('body'),
                    singular = ['apple', 'balloon', 'car', 'dude', 'eagle'],
                    numbers = [4, 9, 16, 25, 36, 49, 64, 81, 100, 121],
                    word = 'Y.Array.map';
                
                body.append('<h2>Pluralizing Words</h2>');
                body.append('<p><b>singular:</b> ' + singular + '</p>');
                plural = Y.Array.map(singular, function (value, index, arr) {
                    return value + 's';
                });
                body.append('<p><b>plural:</b> ' + plural + '</p>');
                body.append('<p><b>singular:</b> ' + singular + '</p>');

                body.append('<hr>');

                body.append('<h2>Square Roots</h2>');
                body.append('<p><b>numbers:</b> ' + numbers + '</p>');
                squareRoots = Y.Array.map(numbers, Math.sqrt);
                body.append('<p><b>squareRoots:</b> ' + squareRoots + '</p>');
                body.append('<p><b>numbers:</b> ' + numbers + '</p>');

                body.append('<hr>');

                body.append('<h2>ASCII map</h2>');
                body.append('<p><b>word:</b> ' + word + '</p>');
                ascii = Y.Array.map(word, function (i) {
                    return i.charCodeAt(0);
                });
                body.append('<p><b>ascii:</b> ' + ascii + '</p>');
                body.append('<p><b>word:</b> ' + word + '</p>');

                body.append('<hr>');
                body.append('<p><i>Examples adapted from <a href="https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/map#Examples">Mozilla Developer Center</a></i></p>');

                // YUI Test
                Y.namespace('Tests');

                Y.Tests.ArrayMap = (function () {
                    var Assert = Y.Assert,
                        suite = new Y.Test.Suite('Array.map Tests');

                    // Test Case for array of strings
                    suite.add(new Y.Test.Case({
                        name: 'Array of Strings',

                        // Setup
                        setUp: function () {
                            this.stringArray = ['foo', 'bar', 'baz'];
                        },

                        // Tests
                        testCount: function () {
                            var original = this.stringArray,
                                result = Y.Array.map(original, function (value) {
                                    return value;
                                });

                            Assert.areEqual(original.length, result.length);
                        },

                        testDoubleEachWord: function () {
                            var original = this.stringArray,
                                result = Y.Array.map(original, function (value) {
                                    return value + value;
                                });

                            
                            // result
                            Assert.areEqual('foofoo', result[0]);
                            Assert.areEqual('barbar', result[1]);
                            Assert.areEqual('bazbaz', result[2]);

                            // original
                            Assert.areEqual('foo', original[0]);
                            Assert.areEqual('bar', original[1]);
                            Assert.areEqual('baz', original[2]);
                        },

                        testConcatValueIndex: function () {
                            var original = this.stringArray,
                                result = Y.Array.map(original, function (value, index) {
                                    return value + '_' + index;
                                });

                            
                            // result
                            Assert.areEqual('foo_0', result[0]);
                            Assert.areEqual('bar_1', result[1]);
                            Assert.areEqual('baz_2', result[2]);

                            // original
                            Assert.areEqual('foo', original[0]);
                            Assert.areEqual('bar', original[1]);
                            Assert.areEqual('baz', original[2]);
                        },

                        testConcatValueIndexArray: function () {
                            var original = this.stringArray,
                                result = Y.Array.map(original, function (value, index, arr) {
                                    return value + '_' + index + '_' + arr;
                                });

                            
                            // result
                            Assert.areEqual('foo_0_foo,bar,baz', result[0]);
                            Assert.areEqual('bar_1_foo,bar,baz', result[1]);
                            Assert.areEqual('baz_2_foo,bar,baz', result[2]);

                            // original
                            Assert.areEqual('foo', original[0]);
                            Assert.areEqual('bar', original[1]);
                            Assert.areEqual('baz', original[2]);
                        }

                    }));

                    // Test Case for array hybrid values
                    suite.add(new Y.Test.Case({
                        name: 'Array of Hybrid Values',

                        // Setup
                        setUp: function () {
                            this.hybridArray = ['foo', '', 123, NaN, true, false, {a: 1, b:'x', c:true}, null, undefined, function (a) {return a.toUpperCase();}, [1, 2, 3]];
                            this.result = Y.Array.map(this.hybridArray, function (value) {
                                return value;
                            });
                        },

                        // Tests
                        testTypeof: function () {
                            var original = this.hybridArray,
                                result = this.result;

                            Assert.isTypeOf('string', result[0]);
                            Assert.isTypeOf('string', result[1]);
                            Assert.isTypeOf('number', result[2]);
                            Assert.isTypeOf('number', result[3]);
                            Assert.isTypeOf('boolean', result[4]);
                            Assert.isTypeOf('boolean', result[5]);
                            Assert.isTypeOf('object', result[6]);
                            Assert.isTypeOf('object', result[7]);
                            Assert.isTypeOf('undefined', result[8]);
                            Assert.isTypeOf('function', result[9]);
                            Assert.isTypeOf('object', result[10]);
                        },

                        testSpecialValues: function () {
                            var original = this.hybridArray,
                                result = this.result;

                            Assert.isNotNaN(result[2]);
                            Assert.isNaN(result[3]);
                            Assert.isTrue(result[4]);
                            Assert.isFalse(result[5]);
                            Assert.isNotNull(result[6]);
                            Assert.isNotUndefined(result[6]);
                            Assert.isNull(result[7]);
                            Assert.isUndefined(result[8]);
                        },

                        testDataType: function () {
                            var original = this.hybridArray,
                                result = this.result;

                            Assert.isString(result[0]);
                            Assert.isString(result[1]);
                            Assert.isNumber(result[2]);
                            Assert.isBoolean(result[4]);
                            Assert.isBoolean(result[5]);
                            Assert.isObject(result[6]);
                            Assert.isFunction(result[9]);
                            Assert.isObject(result[9]);
                            Assert.isArray(result[10]);
                            Assert.isObject(result[10]);
                        },

                        testNestedValues: function () {
                            var original = this.hybridArray,
                                result = this.result;

                            Assert.areSame(1, result[6].a);
                            Assert.areSame('x', result[6].b);
                            Assert.areSame(true, result[6].c);
                            Assert.areSame('FOO', result[9]('foo'));
                            Assert.areSame(1, result[10][0]);
                            Assert.areSame(2, result[10][1]);
                            Assert.areSame(3, result[10][2]);
                        }

                    }));

                    // Test Case for array of numbers
                    suite.add(new Y.Test.Case({
                        name: 'Array of Numbers',

                        // Setup
                        setUp: function () {
                            this.numberArray = [4, 9, 16, 25, 36];
                        },

                        // Tests
                        testSquareRoot: function () {
                            var original = this.numberArray,
                                result = Y.Array.map(original, Math.sqrt);

                            Assert.areSame(2, result[0]);
                            Assert.areSame(3, result[1]);
                            Assert.areSame(4, result[2]);
                            Assert.areSame(5, result[3]);
                            Assert.areSame(6, result[4]);
                        }
                    }));

                    // Test Edge Cases
                    suite.add(new Y.Test.Case({
                        name: 'Edge Cases',

                        // Tests
                        testStringAscii: function () {
                            var word = 'Y.Array.map',
                                result = Y.Array.map(word, function (i) {
                                    return i.charCodeAt(0);
                                });

                            Assert.areSame(89, result[0]);
                            Assert.areSame(46, result[1]);
                            Assert.areSame(65, result[2]);
                            Assert.areSame(114, result[3]);
                            Assert.areSame(114, result[4]);
                            Assert.areSame(97, result[5]);
                            Assert.areSame(121, result[6]);
                            Assert.areSame(46, result[7]);
                            Assert.areSame(109, result[8]);
                            Assert.areSame(97, result[9]);
                            Assert.areSame(112, result[10]);
                        },

                        testEmpty: function () {
                            var empty = [],
                                result = Y.Array.map(empty, function (value) {
                                    return value;
                                });

                            Assert.areEqual(empty.length, result.length);
                        },

                        testUndefinedShouldReturnEmptyArray: function () {
                            var result = Y.Array.map(undefined, function (value) {
                                    return value;
                                });

                            Assert.isArray(result);
                            Assert.areEqual(0, result.length);
                        },

                        testNullShouldReturnEmptyArray: function () {
                            var result = Y.Array.map(null, function (value) {
                                    return value;
                                });

                            Assert.isArray(result);
                            Assert.areEqual(0, result.length);
                        },

                        testStringShouldReturnStringLenghtArray: function () {
                            var result = Y.Array.map('foobar', function (value) {
                                    return value;
                                });

                            Assert.isArray(result);
                            Assert.areEqual(6, result.length);
                            Assert.areSame('f', result[0]);
                            Assert.areSame('o', result[1]);
                            Assert.areSame('o', result[2]);
                            Assert.areSame('b', result[3]);
                            Assert.areSame('a', result[4]);
                            Assert.areSame('r', result[5]);
                        },

                        testObjectShouldReturnEmptyArray: function () {
                            var result = Y.Array.map({foo: 'bar'}, function (value) {
                                    return value;
                                });

                            Assert.isArray(result);
                            Assert.areEqual(0, result.length);
                            Assert.isUndefined(result.foo);
                        }
                    }));

                    return suite;
                }());

                // console
                (new Y.Console({
                    verbose: true,
                    newestOnTop: false
                })).render('#console');

                // add to the test runner and run
                Y.Test.Runner.add(Y.Tests.ArrayMap);
                Y.Test.Runner.run();
            });
        </script>
    </body>
</html>
